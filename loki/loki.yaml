auth_enabled: false

server:
  http_listen_port: 3100
  grpc_listen_port: 9096
  log_level: debug
  log_source_ips_enabled: true

common:
  ring:
    kvstore:
      store: memberlist
    heartbeat_timeout: 10m0s
    zone_awareness_enabled: true
  replication_factor: 2
  path_prefix: /loki

memberlist:
  join_members:
    - "loki.${SERVICE_DISCOVERY_NAMESPACE}"
  advertise_port: 7946
  bind_port: 7945
  rejoin_interval: 15s

ingester:
  lifecycler:
    ring:
      kvstore:
        store: memberlist
      heartbeat_timeout: 10m0s
    join_after: 30s
    min_ready_duration: 30s
    observe_period: 10s
    readiness_check_ring_health: false
  autoforget_unhealthy: true
  chunk_idle_period: 1h
  chunk_target_size: 1572864
  chunk_encoding: snappy
  max_chunk_age: 2h
  wal:
    enabled: true
    dir: /loki/wal
    replay_memory_ceiling: 6GB

distributor:
  ring:
    kvstore:
      store: memberlist
    heartbeat_period: 30s
    heartbeat_timeout: 3m

compactor:
  compactor_ring:
    kvstore:
      store: memberlist
    heartbeat_period: 30s
    heartbeat_timeout: 3m

querier:
  max_concurrent: 2048

query_scheduler:
  max_outstanding_requests_per_tenant: 10000

query_range:
  results_cache:
    cache:
      embedded_cache:
        enabled: true
        max_size_mb: 100

schema_config:
  configs:
    - from: 2020-01-01
      store: tsdb
      object_store: s3
      schema: v12
      index:
        prefix: index_
        period: 24h

storage_config:
  tsdb_shipper:
    active_index_directory: loki/data/tsdb-index
    cache_location: loki/data/tsdb-cache
    shared_store_key_prefix: loki/
    shared_store: s3
  aws:
    bucketnames: ${BUCKET_NAME}
    region: us-gov-west-1
    sse:
      type: SSE-S3

analytics:
 reporting_enabled: false